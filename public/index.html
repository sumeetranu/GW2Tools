<!DOCTYPE>
<html ng-app="myApp">
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
		<script src="controllers/controller.js"></script>
		<link href="style.css" type="text/css" rel="stylesheet" />	
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
		<!-- Optional theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
		<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

		<!-- ng-table -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ng-table/1.0.0/ng-table.min.css">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/ng-table/1.0.0/ng-table.js"></script>


		<!-- Google Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Cormorant+Unicase|Cinzel|Open+Sans|Eczar|Cormorant+Garamond" rel="stylesheet"> 
		<script>
			$(function () {
				$('[data-toggle="popover"]').popover()
			})

			$(document).ready(function() {
    $("body").tooltip({ selector: '[data-toggle=tooltip]' });
});

			$(document).ready(function() {
				$("#helpButton").popover({
					style: 'width:100%',
					placement: 'right',
					html: 'true',
					title : '<span class="text-info"><strong>API Key</strong></span>'+
					'<button type="button" id="close" class="close" onclick="$(&quot;#helpButton&quot;).popover(&quot;hide&quot;);">&times;</button>',
					content : '<p>An API key will allow Guild Wars 2 Tools access to your basic account info. This tool only requires access to your <strong>account</strong> and <strong>progression</strong> (for achievements).</p> <p>Create an API key from <a target="_blank" href="https://account.arena.net/applications">https://account.arena.net/applications</a> with atleast basic account permissions, and enter it below.</p> <p><i>Note: You have the ability to delete the API key from the arena net account page, when you are done.</i></p>'
				});
			});  

			/*API keys are a way to grant third-party tools and applications partial read-only access to your Guild Wars 2 account. To use them, create a key, then copy and paste it into the field provided by the third-party tool or application. Each key is granted a fixed set of permissions that limit what third-party tools can access, and you can delete a key at any time to revoke the permissions granted.
*/
		</script> 
		<title>Guild Wars 2 Tools</title>
	</head>

	<!-- public void do_stuff_plz() {var x = 69;} -->	
	<div id="container" ng-controller="AppCtrl">
		<div id="header">
			<h1 class="pageTitle">Guild Wars 2 Achievs</h1>
		</div>

		<!-- Navbar -->
		<nav class="navbar navbar-default" style="align:center">
			<div class="container">
				<ul class="nav navbar-nav" style="width:100%">
					<!-- <li class="active navbar-left"><a href="#">Home</a></li> -->
					<li class="navbar-plain" ng-if="!basicInfo.name"><a><div></div></a></li>
					<li class="navbar-left" ng-if="basicInfo.name"><a><div class="bootRed"><strong>{{basicInfo.name}}</strong></div></a></li>
					<!-- <li ng-if="basicInfo.name" class="navbar-right">
						<a>
							<div >
								<button class="iconBtn" ng-click="logout()"><i class="glyphicon glyphicon-log-out bootRed" ng-click=""></i> <span style="color:#d9534f">Logout</span></button>
							</div>
						</a>
					</li> -->
				</ul>
			</div>
			<div style="width:100%; background:#d9534f; height:10px"></div>
		</nav>

		<!-- Body -->
		<div id="body">
			<div class="container wrapper">

				<!-- Landing/welcome page -->
				<div ng-if="!basicInfo.name && !loginPage && !loadingData" class="flexbox-container">
					<div>
						<h1 class="bootRed">Welcome to GW2Achievs!</h1>
						<p>Do you wish you had an easier way to search through all of your Guild Wars 2 achievements? This tool allows you to do that, and more! </P>
						<p>Once you Login, you can see a list of all of your achievements, sorted by completion. You can search for achievements by name, and sort by total and tier completion.</p>
						<p>More functionality will be added soon!</p>
						<span style="padding-right:10px; width:10%; height:auto" class="logo-gw2"></span>
						<img class="logo-gw2" src="../img/gw2_logo.png">

					</div>
					<div class="panel panel-default panel-custom centerOnPage" ng-if="!basicInfo.name">
						<div class="panel-body">
							<h2 style="text-align:center" class="bootRed">Login</h2>
							<span style="float:left; padding-right:10px">
								<p>Enter your API Key to link your Guild Wars 2 account</p>
							</span>

							<table class="invisibleTable">
								<tr>
									<td class="alignLeft"><input type="text" class="form-control" id="#auth" placeholder="Enter GW2 API Key" ng-model="accessToken"></td>
									<td class="alignRight fit"><button type="button" class="btn redButton" ng-click="authenticate(accessToken)">Login</button></td>
								</tr>
							</table>
							<br/>
							<div class="alert alert-danger" ng-if="!loginSuccess">
		  						Could not log in using that API Key. Please follow the instructions to generate an API Key (using the help button), and try again. Make sure that the generated API key gives access to <strong>account</strong> and <strong>progression</strong>.
		  					</div>
							<h5 class="bootRed">What is this?</h5>
							<p>API keys are a way to grant third-party tools partial read-only access to your Guild Wars 2 account info. This tool only requires access to your <strong>account</strong> and <strong>progression</strong> (for achievements).</p> <p>Create an API key from the <a target="_blank" href="https://account.arena.net/applications">ArenaNet Application</a> with atleast basic account and progression permissions, and enter it below.</p> <p><i>Note: You have the ability to delete the API key from the arena net account page, when you are done, if you want to. If not, you will be able to use the same API key to login to this website, until you disable or delete it.</i></p>
							<p>For more info on API keys, visit the <a target="_blank" href="https://wiki.guildwars2.com/wiki/API:API_key">GW2 API Keys Wiki Page</a>.</p>
		  					
						</div>
					</div>
				</div>

				<!-- Loading Panel -->	
				<div ng-if="loadingData">
					
					<!--<div class="progress">
						<div class="progress" style="width:100%">
							<div class="progress-bar progress-bar-striped active" role="progress-bar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100" style="width:75%"></div>
						</div>
					</div>-->
					<div style="text-align:center"><span class="glyphicon glyphicon-refresh spinning" style=" font-size: 75px;"></span></div>
					<h1 style="text-align:center">Loading... </h1>
				</div>	

				<!-- Achievements Panel -->
				<div class="panel panel-default panel-custom centerOnPage" ng-if="basicInfo.name && !loadingData">
					<!-- <div class="panel-heading panel-heading-custom"><h3 class="heading-text">Achievement Completion</h3></div> -->
					<div class="panel-body">
						<h2 style="text-align:center" class="bootRed">Achievements</h2>
						<!-- Not logged in yet -->
						<div class="alert alert-warning" ng-if="!basicInfo.name">
	  						Please enter an API Key to log in and view your achievement completion info.
	  					</div>
						<!-- No access to progress -->
						<!--<div class="alert alert-warning" ng-if="basicInfo.name && achievementInfo.length==0">
	  						Please make sure your API Key has access to <strong>progress</strong> to view your achievement completion info.
	  					</div>-->

						<table ng-table="tableParams" class="table" show-filter="true" ng-show="achievementInfo.length>0">
							<tr ng-repeat="achievement in $data">
								<td title="'Name'" filter="{ name: 'text'}" sortable="'name'">
									<span class="description-tooltip" data-toggle="tooltip" data-placement="right" ng-attr-title="{{achievement.description}}">{{achievement.name}}</span>
								</td>
								<td title="'Total Completion'" sortable="'totalPercentage'">
									<span style="float:left; width:calc(100% - 60px); padding-right:5px; cursor: pointer">
										<div class="progress" style="width:100%">
											<div class="progress-bar progress-bar-striped" role="progress-bar" aria-valuenow="{{achievement.totalPercentage}}" aria-valuemin="0" aria-valuemax="100" ng-style="{'width': achievement.totalPercentage + '%'}" data-toggle="tooltip" data-placement="bottom" title="{{achievement.totalCompletion}}"></div>
										</div>
									</span>
									<span style="float:right; width:55px;">{{achievement.totalPercentage}}%</span>
								</td>
							

	    					</tr>
						</table>

					


					</div>
				</div>	
				<br/><br/>
			</div>
			
		</div>

		<div id="footer">
			<table>
				<tr>
					<td style="padding-right:10px; width:10%; height:auto" class="logo-ncsoft"></td>
					<td style="padding-right:10px; width:10%; height:auto" class="logo-arenanet"></td>
					<td><p>Â© 2015 ArenaNet, Inc. All rights reserved. NCsoft, the interlocking NC logo, ArenaNet, Arena.net, Guild Wars, Guild Wars Factions, Factions, Guild Wars Nightfall, Nightfall, Guild Wars: Eye of the North, Eye of the North, Guild Wars 2, and all associated logos and designs are trademarks or registered trademarks of NCsoft Corporation. All other trademarks are the property of their respective owners.</p></td>
				</tr>
			</table>

		</div>
	</div>	

</html>