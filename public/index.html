<!DOCTYPE>
<html ng-app="myApp">
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
		<script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.7/angular.min.js"></script>
		<script src="controllers/controller.js"></script>
		<link href="style.css" type="text/css" rel="stylesheet" />	
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
		<!-- Optional theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
		<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

		<!-- ng-table -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ng-table/1.0.0/ng-table.min.css">
		<script src="https://cdnjs.cloudflare.com/ajax/libs/ng-table/1.0.0/ng-table.js"></script>


		<!-- Google Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Cinzel" rel="stylesheet"> 

		<script>
			$(function () {
				$('[data-toggle="popover"]').popover()
			})

			$(document).ready(function() {
    $("body").tooltip({ selector: '[data-toggle=tooltip]' });
});

			$(document).ready(function() {
				$("#helpButton").popover({
					style: 'width:100%',
					placement: 'right',
					html: 'true',
					title : '<span class="text-info"><strong>API Key</strong></span>'+
					'<button type="button" id="close" class="close" onclick="$(&quot;#helpButton&quot;).popover(&quot;hide&quot;);">&times;</button>',
					content : '<p>An API key will allow Guild Wars 2 Tools access to your basic account info. This tool only requires access to your <strong>account</strong> and <strong>progression</strong> (for achievements).</p> <p>Create an API key from <a target="_blank" href="https://account.arena.net/applications">https://account.arena.net/applications</a> with atleast basic account permissions, and enter it below.</p> <p><i>Note: You have the ability to delete the API key from the arena net account page, when you are done.</i></p>'
				});
			});  

		</script> 
		<title>Guild Wars 2 Tools</title>
	</head>

	<!-- public void do_stuff_plz() {var x = 69;} -->	
	<body>
		<div class="container" ng-controller="AppCtrl">
			<br/>
			<div class="panel panel-default">
				<div class="panel-heading">
					<table class="invisibleTable">
					<tr>
						<td><h3>Authentication</h3></td>
						<td class="alignRight">{{basicInfo.name}}</td>
					</tr>
					</table>

					
				</div>
				<div class="panel-body">
					<span style="float:left; padding-right:10px">
						<p>Enter your API Key to link your Guild Wars 2 account</p>
					</span>
					<div>
						<button id="helpButton" type="button" class="iconBtn"><i class="glyphicon glyphicon-question-sign redIcon"></i></button>
					</div>

					<table class="invisibleTable">
						<tr>
							<td class="alignLeft"><input type="text" class="form-control" id="#auth" placeholder="Enter GW2 API Key" ng-model="accessToken"></td>
							<td class="alignRight fit"><button type="button" class="btn btn-primary" ng-click="authenticate(accessToken)">Authenticate</button></td>
						</tr>
					</table>
					<br/>
					<div class="alert alert-success" ng-if="basicInfo.name">
						<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
    					<p>Welcome <strong>{{basicInfo.name}}</strong>! Here are a few hints on using this tool: </p>
    					<ol>
	    					<li>
	    						Use the Achievements table's title bar to sort achievements by total completion or tier completion.
	    					</li>
	    					<li>
	    						Hover over the achievement names and completion bars to see additional info.
	    					</li>
	    					<li>
	    						As of now, your account information will not be saved and will get reset when you close your browser or reload the page. However, you can save your API Key somewhere convenient, to make it easier to re-enter it.
	    					</li>
    					</ol>
  					</div>

  					<div class="alert alert-danger" ng-if="!loginSuccess">
  						<a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
  						Could not log in using that API Key. Please follow the instructions to generate an API Key (using the help button), and try again. Make sure that the generated API key gives access to <strong>account</strong> and <strong>progression</strong>.
  					</div>

				</div>
			</div>

			<div class="panel panel-default">
				<div class="panel-heading"><h3>Achievement Completion</h3></div>
				<div class="panel-body">

					<!-- Not logged in yet -->
					<div class="alert alert-warning" ng-if="!basicInfo.name">
  						Please enter an API Key to log in and view your achievement completion info.
  					</div>
					<!-- No access to progress -->
					<div class="alert alert-warning" ng-if="basicInfo.name && achievementInfo.length==0">
  						Please make sure your API Key has access to <strong>progress</strong> to view your achievement completion info.
  					</div>

					<table ng-table="tableParams" class="table" show-filter="true" ng-show="achievementInfo.length>0">
						<tr ng-repeat="achievement in $data">
							<td title="'Name'" filter="{ name: 'text'}" sortable="'name'">
								<span data-toggle="tooltip" data-placement="right" ng-attr-title="{{achievement.name}}">{{achievement.name}}</span>
							</td>
							<td title="'Total Completion'" sortable="'totalPercentage'">
								<span style="float:left; width:calc(100% - 60px); padding-right:5px; cursor: pointer">
									<div class="progress" style="width:100%">
										<div class="progress-bar progress-bar-striped" role="progress-bar" aria-valuenow="{{achievement.totalPercentage}}" aria-valuemin="0" aria-valuemax="100" ng-style="{'width': achievement.totalPercentage + '%'}" data-toggle="tooltip" data-placement="bottom" title="{{achievement.totalCompletion}}"></div>
									</div>
								</span>
								<span style="float:right; width:55px;">{{achievement.totalPercentage}}%</span>
							</td>
						

    					</tr>
					</table>

				


				</div>
			</div>	
		</div>
	</body>
</html>